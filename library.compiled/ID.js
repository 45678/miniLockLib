// Generated by CoffeeScript 1.7.1
(function() {
  var BLAKE2s, Base58, ID;

  Base58 = require("./Base58");

  BLAKE2s = require("./BLAKE2s");

  ID = module.exports = {};

  ID.isAcceptable = function(id) {
    return /^[1-9A-Za-z]{40,55}$/.test(id) && (ID.decode(id) != null);
  };

  ID.encode = function(publicKey) {
    var index, slots, _i;
    if ((publicKey != null ? publicKey.length : void 0) === 32) {
      slots = new Uint8Array(33);
      for (index = _i = 0; _i <= 32; index = ++_i) {
        slots[index] = publicKey[index];
      }
      slots[32] = (new BLAKE2s({
        length: 1
      })).update(publicKey).digest()[0];
      return Base58.encode(slots);
    } else {
      return void 0;
    }
  };

  ID.decode = function(id) {
    var encodedChecksum, publicKey, slots, trueChecksum;
    slots = Base58.decode(id);
    if (slots.length === 33) {
      publicKey = new Uint8Array(slots.subarray(0, 32));
      encodedChecksum = slots[32];
      trueChecksum = (new BLAKE2s({
        length: 1
      })).update(publicKey).digest()[0];
      if (encodedChecksum === trueChecksum) {
        return publicKey;
      }
    }
    return void 0;
  };

}).call(this);
